<html>

<head>
    <script src="pixi.js"></script>
    <script src="pixi.min.js"></script>
    <meta charset="utf-8">

</head>

<body>
    <script>
        var app = new PIXI.Application({
            width: 800,
            height: 600,
            backgroundColor: 0xF0BBFF,
            antialias: true,
            forceCanvas: false
        }); //設定圖層
        document.body.appendChild(app.view); //顯示
        var container = new PIXI.Container();
        app.stage.addChild(container);

       /* const girl = PIXI.Sprite.from('girl.png');
        //boy.anchor.set(0.5);
        girl.scale.x = 0.2;
        girl.scale.y = 0.2;
        girl.position.set(-200, 0);
        container.addChild(girl);*/
        
        let girl=["牛郎織女動圖/織女奔跑/織女拆圖合併-run_00.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_01.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_02.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_03.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_04.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_05.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_06.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_07.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_08.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_09.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_10.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_11.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_12.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_13.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_14.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_15.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_16.png","牛郎織女動圖/織女奔跑/織女拆圖合併-run_17.png"];
         let textureArray_g = [];

        for (let i = 0; i < 18; i++) {
            let texture = PIXI.Texture.fromImage(girl[i]);

           textureArray_g.push(texture);
        };
        let girlanisprite = new PIXI.AnimatedSprite(textureArray_g);
        girlanisprite.position.set(-300,0);
        girlanisprite.scale.set(0.1);
        girlanisprite.animationSpeed=0.8;
        girlanisprite.play();
        container.addChild(girlanisprite);

        //遊玩控制
        var circle = new PIXI.Graphics();
        circle.beginFill(0xFF8888);
        //drawCircle(x,y,r)
        circle.drawCircle(400, 500, 50);
        circle.interactive = true;
        circle.buttonMode = true;
        circle.visible = false;
        container.addChild(circle);


        //開始按鈕
        var start = new PIXI.Graphics();
        start.beginFill(0xFFFF77);
        //drawCircle(x,y,r)
        start.drawCircle(100, 500, 50);
        start.interactive = true;
        start.buttonMode = true;
        container.addChild(start);
        var text = new PIXI.Text("GO!");
        text.position.set(130, 530);
        text.pivot.x = start.width / 2;
        text.pivot.y = start.height / 2;
        start.addChild(text);

        //遊戲結束按鈕
        var finish=new PIXI.Graphics();
        finish.beginFill(0xDDDDDD);
        finish.drawCircle(200,200,100);
        finish.interactive = true;
        finish.buttonMode = true;
        container.addChild(finish);
        var text_finish=new PIXI.Text("FINISH");
        text_finish.position.set(260,280);
        text_finish.pivot.x = finish.width / 2;
        text_finish.pivot.y = finish.height / 2;
        finish.addChild(text_finish);
        finish.visible=false;
       
        
        



        //控制動畫
        app.ticker.add((delta) => {
            circle.on('pointertap', onClick);
            start.on('pointertap', startgame);
            // boy.position.x-=5*delta;

            function onClick() {

                girlanisprite.position.x += 0.2*delta ;
                setTimeout(function() {

                    app.ticker.stop();

                }, 30000);

            }

            function startgame() {
                //start.destroy();
                start.visible=false;
                circle.visible = true;
                app.ticker.add((delta) => {
                    girlanisprite.position.x -= 0.05 * delta;
                    setTimeout(function(){
                        girlanisprite.position.x-=0.5*delta;
                    },4000);
                      /*setTimeout(function(){
                        boy.position.x-=6*delta;
                    },5000);
                      setTimeout(function(){
                        boy.position.x-=6.5*delta;
                    },5000);*/
                });

            }
            //贏的條件
            if(girlanisprite.position.x>=500)
                {
                    app.ticker.stop();
                    finish.visible=true;
                     finish.on('pointertap',win);
                    function win()
                    {
                        location.href='start.html';
                    }
                }
            //輸的條件
            if(girlanisprite.position.x<-450)
                {
                    app.ticker.stop();
                    text_finish.text="you lose";
                    finish.visible=true;
                    finish.on('pointertap',lose);
                    function lose()
                    {
                        location.href='start.html';
                    }
                }
           
        });



        //保持全螢幕
        window.addEventListener('resize', resize);

        function resize() {
            app.renderer.resize(window.innerWidth, window.innerHeight);
            container.x = app.screen.width / 2;
            container.y = app.screen.height / 2;
            container.pivot.x = container.width / 2;
            container.pivot.y = container.height / 2;
        }
        resize();

    </script>



</body>

</html>
