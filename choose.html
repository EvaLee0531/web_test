<html>

<head>
    <script src="pixi.js"></script>
    <script src="pixi.min.js"></script>
    <meta charset="utf-8">

</head>
<style>
    body {
        position: absolute;
        margin: 0 auto;
        overflow: hidden;
    }

</style>

<body>

    <script>
        var app = new PIXI.Application({
            antialias: true,
            forceCanvas: false
        }); //設定圖層
        document.body.appendChild(app.view); //顯示
        var container = new PIXI.Container();
        app.stage.addChild(container);

        //遊戲背景
        var ratio = Math.min(window.innerWidth, window.innerHeight);
        var backgroundimg = PIXI.Sprite.from("牛郎織女2/遊戲背景/遊戲主畫面背景.png");
        backgroundimg.width = ratio;
        backgroundimg.height = ratio;
        backgroundimg.anchor.set(0.5);
        container.addChild(backgroundimg);

        //牛郎
        const boyFrames = ["牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_00.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_01.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_02.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_03.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_04.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_05.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_06.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_07.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_08.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_09.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_10.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_11.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_12.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_13.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_14.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_15.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_16.png", "牛郎織女動圖/牛郎選擇圖/牛郎拆圖合併-腳色選擇_17.png"];

        const girlFrames = ["牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_00.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_01.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_02.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_03.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_04.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_05.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_06.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_07.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_08.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_09.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_10.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_11.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_12.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_13.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_14.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_15.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_16.png", "牛郎織女動圖/織女選擇圖/織女拆圖合併-織女ch_17.png"];
        PIXI.loader.add(boyFrames).add(girlFrames).load(setup).on("progress", loadProgressHandler);

        function setup() {
            //resources可以初始化背景圖片
            let resources = PIXI.loader.resources;
            animatedBoy = PIXI.extras.AnimatedSprite.fromFrames(boyFrames);
            animatedBoy.animationSpeed = 0.5;
            animatedBoy.scale.set(0.2, 0.2);
            animatedBoy.anchor.set(0.5);
            animatedBoy.position.set(200, 0);
            animatedBoy.play();
            backgroundimg.addChild(animatedBoy);
            animatedBoy.interactive = true;
            animatedBoy.buttonMode = true;
            animatedBoy.on('pointerdown', boyplay);

            animatedBoy.mouseover = function(mouseData) {
                this.alpha = 0.8;
            }
            animatedBoy.mouseout = function(mouseData) {
                this.alpha = 1;
            }


            function boyplay() {
                location.href = "boy.html";
            }

            animatedGirl = PIXI.extras.AnimatedSprite.fromFrames(girlFrames);
            animatedGirl.animationSpeed = 0.5;
            animatedGirl.scale.set(0.2, 0.2);
            animatedGirl.anchor.set(0.5);
            animatedGirl.position.set(-200, 0);
            animatedGirl.play();
            backgroundimg.addChild(animatedGirl);
            animatedGirl.interactive = true;
            animatedGirl.buttonMode = true;
            animatedGirl.on('pointerdown', girlplay);

            animatedGirl.mouseover = function(mouseData) {
                this.alpha = 0.8;
            }
            animatedGirl.mouseout = function(mouseData) {
                this.alpha = 1;
            }


            function girlplay() {
                location.href = "girl.html";
            }


        }
           //loading
        var loading = new PIXI.Text("Loading...");
        loading.anchor.set(0.5);
        loading.scale.set(2,2);
        loading.position.set(0,0);
        backgroundimg.addChild(loading);
        app.ticker.add(function(delta){
            
            if(loading.alpha==0)
                {
                    loading.alpha+=0.05*delta;
                    
                }
            else if(loading.alpha>0){
                loading.alpha-=0.05*delta;
                
            }
        });


        function loadProgressHandler(loader, resource) {

            console.log(resource.name+","+loader.progress+"%");
            if(loader.progress>=99)
                {
                    loading.visible=false;
                }
        }
     
        //保持全螢幕
        window.addEventListener('resize', resize);

        function resize() {
            app.renderer.resize(window.innerWidth, window.innerHeight);
            container.x = app.screen.width / 2;
            container.y = app.screen.height / 2;
            container.anchor = 0.5;
        }
        resize();

    </script>

</body>

</html>
